# Parser Service API

Сервис для парсинга веб-данных с предоставлением REST API для доступа к результатам.

## Структура проекта

```
/parser-service/
├── cmd/                    # Точка входа приложения
│   └── main.go            # Основной файл приложения
├── internal/              # Внутренний код (не экспортируется)
│   ├── config/           # Конфигурация приложения
│   ├── models/           # Структуры данных и модели
│   ├── parser/           # Логика парсинга веб-страниц
│   ├── handlers/         # HTTP обработчики API
│   └── cache/            # Кеширование данных
├── pkg/                  # Публичный код (экспортируется)
│   ├── utils/           # Вспомогательные функции
│   └── logger/          # Логирование
├── api/                  # Спецификации API
│   └── v1/              # Версия API v1
├── web/                  # Веб-ресурсы
│   ├── static/          # Статические файлы (CSS, JS, изображения)
│   └── templates/       # HTML шаблоны
├── docs/                 # Документация
├── scripts/              # Скрипты сборки, развертывания
├── tests/                # Тесты
├── go.mod               # Go модули
└── go.sum               # Checksums зависимостей
```

## Описание директорий

### cmd/
Содержит точки входа приложения. Обычно один main.go файл на приложение.

### internal/
Внутренний код приложения, который не предназначен для импорта внешними пакетами.

- **config/**: Загрузка и управление конфигурацией (переменные окружения, файлы конфигурации)
- **models/**: Структуры данных, модели базы данных, DTO объекты
- **parser/**: Логика парсинга веб-страниц, работа с HTML, извлечение данных
- **handlers/**: HTTP обработчики для API endpoints, middleware
- **cache/**: Кеширование результатов парсинга (Redis, in-memory cache)

### pkg/
Публичный код, который может быть использован другими приложениями.

- **utils/**: Общие вспомогательные функции (валидация, форматирование)
- **logger/**: Настраиваемое логирование с различными уровнями

### api/
Спецификации API, документация endpoints, версии API.

- **v1/**: Первая версия API с описанием всех доступных endpoints

### web/
Веб-ресурсы для пользовательского интерфейса (если планируется).

- **static/**: CSS, JavaScript, изображения
- **templates/**: HTML шаблоны для рендеринга страниц

### docs/
Дополнительная документация проекта, API документация, примеры использования.

### scripts/
Скрипты для сборки, тестирования, развертывания, миграций базы данных.

### tests/
Интеграционные и unit тесты.

## Архитектура

Сервис построен по принципам чистой архитектуры:

1. **Парсер** (`internal/parser/`) - отвечает за извлечение данных из веб-источников
2. **Модели** (`internal/models/`) - определяют структуру данных
3. **Обработчики** (`internal/handlers/`) - реализуют REST API
4. **Кеш** (`internal/cache/`) - оптимизирует производительность
5. **Конфигурация** (`internal/config/`) - управляет настройками

## Запуск

После создания необходимых файлов в соответствующих директориях:

```bash
# Установка зависимостей
go mod tidy

# Запуск сервера
go run cmd/main.go
```

## API Endpoints

- `GET /api/v1/articles` - Получить список статей
- `GET /api/v1/articles/{id}` - Получить статью по ID
- `POST /api/v1/parse` - Запустить парсинг (если поддерживается)

## Конфигурация

Сервис настраивается через переменные окружения:

- `PORT` - Порт сервера (по умолчанию 8080)
- `DATABASE_URL` - URL базы данных
- `REDIS_URL` - URL Redis для кеширования
- `LOG_LEVEL` - Уровень логирования

## Разработка

### Добавление нового парсера

1. Создать структуру в `internal/models/`
2. Реализовать логику парсинга в `internal/parser/`
3. Добавить обработчик в `internal/handlers/`
4. Обновить маршруты в `cmd/main.go`

### Добавление нового API endpoint

1. Создать обработчик в `internal/handlers/`
2. Зарегистрировать маршрут в роутере
3. Обновить документацию API

## Тестирование

```bash
# Запуск всех тестов
go test ./...

# Запуск с покрытием
go test -cover ./...
```

## Развертывание

Для развертывания можно использовать Docker. Создайте соответствующие файлы `Dockerfile` и `docker-compose.yml` в корне проекта.
